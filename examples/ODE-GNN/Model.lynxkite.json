{
  "edges": [
    {
      "id": "MSE loss 1 Optimizer 1",
      "source": "MSE loss 1",
      "sourceHandle": "output",
      "target": "Optimizer 1",
      "targetHandle": "loss"
    },
    {
      "id": "Output 1 x MSE loss 1 x",
      "source": "Output 1",
      "sourceHandle": "x",
      "target": "MSE loss 1",
      "targetHandle": "x"
    },
    {
      "id": "LSTM 1 output Linear 1 x",
      "source": "LSTM 1",
      "sourceHandle": "output",
      "target": "Linear 1",
      "targetHandle": "x"
    },
    {
      "id": "Neural ODE with MLP 1 output Output 1 x",
      "source": "Neural ODE with MLP 1",
      "sourceHandle": "output",
      "target": "Output 1",
      "targetHandle": "x"
    },
    {
      "id": "Linear 1 output Concatenate 2 b",
      "source": "Linear 1",
      "sourceHandle": "output",
      "target": "Concatenate 2",
      "targetHandle": "b"
    },
    {
      "id": "Drug, disease, gene GNN 1 output Concatenate 2 a",
      "source": "Drug, disease, gene GNN 1",
      "sourceHandle": "output",
      "target": "Concatenate 2",
      "targetHandle": "a"
    },
    {
      "id": "Input: sequential 2 input Neural ODE with MLP 1 timestamps",
      "source": "Input: sequential 2",
      "sourceHandle": "input",
      "target": "Neural ODE with MLP 1",
      "targetHandle": "timestamps"
    },
    {
      "id": "Input: sequential 1 input MSE loss 1 y",
      "source": "Input: sequential 1",
      "sourceHandle": "input",
      "target": "MSE loss 1",
      "targetHandle": "y"
    },
    {
      "id": "Input: sequential 3 input LSTM 1 x",
      "source": "Input: sequential 3",
      "sourceHandle": "input",
      "target": "LSTM 1",
      "targetHandle": "x"
    },
    {
      "id": "Input: drug-targets-gene graph 1 input Drug, disease, gene GNN 1 drug_edges",
      "source": "Input: drug-targets-gene graph 1",
      "sourceHandle": "input",
      "target": "Drug, disease, gene GNN 1",
      "targetHandle": "drug_edges"
    },
    {
      "id": "Input: gene-interacts-gene graph 1 input Drug, disease, gene GNN 1 gene_edges",
      "source": "Input: gene-interacts-gene graph 1",
      "sourceHandle": "input",
      "target": "Drug, disease, gene GNN 1",
      "targetHandle": "gene_edges"
    },
    {
      "id": "Input: disease-assoc-gene graph 1 input Drug, disease, gene GNN 1 disease_edges",
      "source": "Input: disease-assoc-gene graph 1",
      "sourceHandle": "input",
      "target": "Drug, disease, gene GNN 1",
      "targetHandle": "disease_edges"
    },
    {
      "id": "Input: gene features 1 input Drug, disease, gene GNN 1 gene_nodes",
      "source": "Input: gene features 1",
      "sourceHandle": "input",
      "target": "Drug, disease, gene GNN 1",
      "targetHandle": "gene_nodes"
    },
    {
      "id": "Concatenate 2 output Neural ODE with MLP 1 state_0",
      "source": "Concatenate 2",
      "sourceHandle": "output",
      "target": "Neural ODE with MLP 1",
      "targetHandle": "state_0"
    }
  ],
  "env": "PyTorch model",
  "nodes": [
    {
      "data": {
        "__execution_delay": null,
        "collapsed": null,
        "display": null,
        "error": "Unknown operation.",
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Group",
        "params": {
          "color": "orange"
        },
        "status": "done",
        "title": "Group"
      },
      "height": 1266.0,
      "id": "Group 2",
      "position": {
        "x": -1040.7544742401944,
        "y": 20.00160785582024
      },
      "selected": true,
      "type": "node_group",
      "width": 1384.0
    },
    {
      "data": {
        "__execution_delay": null,
        "collapsed": null,
        "display": null,
        "error": "Unknown operation.",
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Group",
        "params": {
          "color": "blue"
        },
        "status": "done",
        "title": "Group"
      },
      "height": 1049.0,
      "id": "Group 1",
      "position": {
        "x": 504.62545496173914,
        "y": -48.52927736567699
      },
      "type": "node_group",
      "width": 673.0
    },
    {
      "data": {
        "__execution_delay": null,
        "collapsed": null,
        "display": null,
        "error": "Unknown operation.",
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Group",
        "params": {
          "color": "purple"
        },
        "status": "done",
        "title": "Group"
      },
      "height": 896.0,
      "id": "Group 5",
      "position": {
        "x": 593.8616229610058,
        "y": -2144.434037892992
      },
      "type": "node_group",
      "width": 801.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": false,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "LSTM",
        "params": {
          "dropout": "0",
          "hidden_size": "32",
          "input_size": "1"
        },
        "status": "done",
        "title": "LSTM"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 312.0,
      "id": "LSTM 1",
      "parentId": "Group 1",
      "position": {
        "x": 40.0,
        "y": 320.0
      },
      "selected": false,
      "type": "basic",
      "width": 204.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": false,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Input: sequential",
        "params": {
          "_input_name": "future volumes",
          "per_sample": true
        },
        "status": "done",
        "title": "Input: sequential"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 280.0,
      "id": "Input: sequential 1",
      "parentId": "Group 5",
      "position": {
        "x": 343.4106994360478,
        "y": 556.0747592757436
      },
      "selected": false,
      "type": "basic",
      "width": 237.0
    },
    {
      "data": {
        "__execution_delay": null,
        "collapsed": true,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "MSE loss",
        "params": {},
        "status": "done",
        "title": "MSE loss"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 69.0,
      "id": "MSE loss 1",
      "parentId": "Group 5",
      "position": {
        "x": 70.0,
        "y": 404.6042243521049
      },
      "selected": false,
      "type": "basic",
      "width": 200.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Optimizer",
        "params": {
          "lr": "0.0001",
          "type": "AdamW"
        },
        "status": "done",
        "title": "Optimizer"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 247.0,
      "id": "Optimizer 1",
      "parentId": "Group 5",
      "position": {
        "x": 70.38043796663555,
        "y": 45.0
      },
      "selected": false,
      "type": "basic",
      "width": 190.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Input: sequential",
        "params": {
          "_input_name": "future timestamps",
          "per_sample": true
        },
        "status": "done",
        "title": "Input: sequential"
      },
      "dragHandle": ".drag-handle",
      "height": 299.0,
      "id": "Input: sequential 2",
      "position": {
        "x": 1251.8384360117905,
        "y": -53.7000628740369
      },
      "type": "basic",
      "width": 230.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Neural ODE with MLP",
        "params": {
          "absolute_tolerance": "0.001",
          "method": "dopri5",
          "mlp_activation": "ReLU",
          "mlp_hidden_size": "64 ",
          "mlp_layers": "2",
          "relative_tolerance": "0.001                                                                 ",
          "state_dimensions": "192"
        },
        "status": "done",
        "title": "Neural ODE with MLP"
      },
      "dragHandle": ".drag-handle",
      "height": 600.0,
      "id": "Neural ODE with MLP 1",
      "position": {
        "x": 600.0,
        "y": -960.0
      },
      "type": "basic",
      "width": 280.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Input: sequential",
        "params": {
          "_input_name": "past volumes",
          "per_sample": true
        },
        "status": "done",
        "title": "Input: sequential"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 288.0,
      "id": "Input: sequential 3",
      "parentId": "Group 1",
      "position": {
        "x": 40.0,
        "y": 680.0
      },
      "selected": false,
      "type": "basic",
      "width": 210.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Output",
        "params": {
          "name": "future volume predictions"
        },
        "status": "done",
        "title": "Output"
      },
      "dragHandle": ".drag-handle",
      "height": 160.0,
      "id": "Output 1",
      "position": {
        "x": 600.0,
        "y": -1200.0
      },
      "type": "basic",
      "width": 280.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": "Unknown operation.",
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Comment",
        "params": {
          "text": "# Past tumor volume embedding with LSTM"
        },
        "status": "done",
        "title": "Comment"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 130.0,
      "id": "Comment 1",
      "parentId": "Group 1",
      "position": {
        "x": 273.0000000000001,
        "y": 326.7328697315139
      },
      "selected": false,
      "type": "comment",
      "width": 400.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": "Unknown operation.",
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Comment",
        "params": {
          "text": "# Tumor volume trajectory predictions with ODE\n\nAn MLP is used to predict the derivative of the tumor volume at different stages, based on the knowledge graph embedding and the past tumor volume embeddings."
        },
        "status": "done",
        "title": "Comment"
      },
      "dragHandle": ".drag-handle",
      "height": 274.0,
      "id": "Comment 6",
      "position": {
        "x": 62.18097447139637,
        "y": -867.7619665323152
      },
      "type": "comment",
      "width": 400.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": "Unknown operation.",
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Comment",
        "params": {
          "text": "# Training configuration\n\nThe loss for the whole model is simply the MSE loss over the future volume measurements."
        },
        "status": "done",
        "title": "Comment"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 138.0,
      "id": "Comment 7",
      "parentId": "Group 5",
      "position": {
        "x": 301.18914557042024,
        "y": 257.8721350317928
      },
      "selected": false,
      "type": "comment",
      "width": 400.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Linear",
        "params": {
          "output_dim": "128"
        },
        "status": "done",
        "title": "Linear"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 200.0,
      "id": "Linear 1",
      "parentId": "Group 1",
      "position": {
        "x": 40.0,
        "y": 80.0
      },
      "selected": false,
      "type": "basic",
      "width": 200.0
    },
    {
      "data": {
        "collapsed": true,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Concatenate",
        "params": {},
        "status": "done",
        "title": "Concatenate"
      },
      "dragHandle": ".drag-handle",
      "height": 69.0,
      "id": "Concatenate 2",
      "position": {
        "x": 210.60112224325755,
        "y": -268.54490939988654
      },
      "type": "basic",
      "width": 200.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Drug, disease, gene GNN",
        "params": {
          "gene_in_dim": "1281",
          "hidden_dim": "64",
          "num_diseases": "6",
          "num_drugs": "62",
          "out_dim": "64"
        },
        "status": "done",
        "title": "Drug, disease, gene GNN"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 490.0,
      "id": "Drug, disease, gene GNN 1",
      "parentId": "Group 2",
      "position": {
        "x": 441.4224106385949,
        "y": 50.0
      },
      "selected": false,
      "type": "basic",
      "width": 893.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Input: disease-assoc-gene graph",
        "params": {
          "_input_name": "disease-assoc-gene"
        },
        "status": "done",
        "title": "Input: disease-assoc-gene graph"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 200.0,
      "id": "Input: disease-assoc-gene graph 1",
      "parentId": "Group 2",
      "position": {
        "x": 866.5490252186046,
        "y": 1015.671286298793
      },
      "selected": false,
      "type": "basic",
      "width": 200.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Input: drug-targets-gene graph",
        "params": {
          "_input_name": "drug-targets-gene"
        },
        "status": "done",
        "title": "Input: drug-targets-gene graph"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 200.0,
      "id": "Input: drug-targets-gene graph 1",
      "parentId": "Group 2",
      "position": {
        "x": 706.5490252186046,
        "y": 735.671286298793
      },
      "selected": false,
      "type": "basic",
      "width": 200.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Input: gene features",
        "params": {
          "_input_name": "gene-embeddings"
        },
        "status": "done",
        "title": "Input: gene features"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 200.0,
      "id": "Input: gene features 1",
      "parentId": "Group 2",
      "position": {
        "x": 506.5490252186047,
        "y": 1015.671286298793
      },
      "selected": false,
      "type": "basic",
      "width": 200.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": null,
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Input: gene-interacts-gene graph",
        "params": {
          "_input_name": "gene-interacts-gene"
        },
        "status": "done",
        "title": "Input: gene-interacts-gene graph"
      },
      "dragHandle": ".drag-handle",
      "extent": "parent",
      "height": 200.0,
      "id": "Input: gene-interacts-gene graph 1",
      "parentId": "Group 2",
      "position": {
        "x": 1066.5490252186046,
        "y": 735.671286298793
      },
      "selected": false,
      "type": "basic",
      "width": 200.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": "Unknown operation.",
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Comment",
        "params": {
          "text": "# Graph embedding\n\nWe take the tissue-specific PPI graph plus the drug-targets-gene and disease-associated-with-gene edges to construct the graph.\n\nThe GNN state of the gene nodes is initialized with the gene-embeddings vectors. For the drug and disease nodes the initial embedding is learned.\n\nThis custom GNN box hides a lot of complexity, including the way the graph-level embedding is generated from the node-level embeddings."
        },
        "status": "done",
        "title": "Comment"
      },
      "extent": "parent",
      "height": 402.0,
      "id": "Comment 2",
      "parentId": "Group 2",
      "position": {
        "x": 50.0,
        "y": 349.3127056919966
      },
      "selected": false,
      "type": "comment",
      "width": 400.0
    },
    {
      "data": {
        "__execution_delay": 0.0,
        "collapsed": null,
        "display": null,
        "error": "Unknown operation.",
        "expanded_height": null,
        "input_metadata": null,
        "meta": null,
        "op_id": "Comment",
        "params": {
          "text": ":::highlight\n# Overview\n\nThis is the architecture of our ODE+GNN tumor volume prediction model. The three main parts of the model are:\n- Take a sample-specific graph that includes one drug node and one disease node, both connected to their associated gene nodes, and gene nodes are connected to each other based on the tissue-specific PPI data. A custom GNN processes this graph into a graph embedding.\n- Take the past tumor volume time series data and process it into an embedding with an LSTM.\n- Take the future timestamps and generate predictions for them with a neural ODE module conditioned on the combined embeddings the the graph and the time series.\n\nThe loss function is computed by comparing the predictions to the ground truth data."
        },
        "status": "done",
        "title": "Comment"
      },
      "height": 1530.0,
      "id": "Comment 3",
      "position": {
        "x": -784.3153207697787,
        "y": -2048.744876238401
      },
      "type": "comment",
      "width": 400.0
    }
  ],
  "paused": false
}
